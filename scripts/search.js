const initSearch=(e,t)=>{const n=(new Date).getTime();const{searchParams:s}=new URL(location.href);const i=s.get("s");const r=["<p>这是宝硕博客的站内搜索引擎。</p>",'<p>搜索多个关键词时请用空格分隔,如「<a href="https://blog.baoshuo.ren/search/?s=网页+深色模式">网页 深色模式</a>」、「<a href="https://blog.baoshuo.ren/search/?s=CTF+Write+Up">CTF Write Up</a>」</p>'].join("");const c=[`<p>找不到和「${i}」相符的文章。`,`<small>（耗时 <span id="search-used-time">null</span> 毫秒）</small>`,`</p>`,`<p>请检查关键字是否有误，或尝试搜索其它关键字。你也可以前往 `,`<a href="https://www.google.com/search?q=site%3Ablog.baoshuo.ren%20${encodeURIComponent(i)}">Google</a>`,` 或 <a href="https://www.bing.com/search?q=site%3Ablog.baoshuo.ren%20${encodeURIComponent(i)}">Bing</a>`,` 搜索「${i}」。`,`</p>`].join("");const o=['<p style="text-align: center;">获取文章数据出错，请尝试 <a href="javascript:locaton.reload();">重新加载</a> 。</p>'].join("");if(i===null||i.trim()===""){t.innerHTML=r}else{e.value=i;fetch("/search.json").then((e=>e.json())).then((e=>{let s=new Fuse(e,{includeMatches:true,threshold:.4,keys:["title","content"]}).search(i);let r=['<div id="search-result-info" class="search-result-info"></div>'];console.log("Search result:",s);s.forEach((e=>{(t=>{e.item.content=e.item.content.trim();r.push(['<div class="divider"></div>','<a href="'+e.item.url.substring(1,e.item.url.length)+'" class="search-result-link">','<div class="search-result-item">','<div class="search-result-item-title">',t.key==="title"?[e.item.title.substring(0,t.indices[0][0]),"<mark>",e.item.title.substring(t.indices[0][0],t.indices[0][1]+1),"</mark>",e.item.title.substring(t.indices[0][1]+1,e.item.title.length)].join(""):e.item.title,"</div>",'<div class="search-result-item-description">',t.key==="content"?[e.item.content.substring(t.indices[0][0]-30,t.indices[0][0]),"<mark>",e.item.content.substring(t.indices[0][0],t.indices[0][1]+1),"</mark>",e.item.content.substring(t.indices[0][1]+1,t.indices[0][1]+130)].join(""):e.item.content.substring(0,80),"</div>","</div>","</a>"].join(""))})(e.matches[0])}));const o=(new Date).getTime();if(!s.length){t.innerHTML=c;document.getElementById("search-used-time").innerHTML=o-n}else{t.innerHTML=r.join("\n");document.getElementById("search-result-info").innerHTML=`<b>搜索结果</b><small>（耗时 ${o-n} 毫秒）</small>`}})).catch((e=>{console.error(e);t.innerHTML=o}))}};initSearch(document.getElementById("search-input"),document.getElementById("search-result"));